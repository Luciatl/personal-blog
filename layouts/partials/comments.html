<script src="https://giscus.app/client.js"
        data-repo="tianalei/personal-blog"
        data-repo-id="R_kgDONLoiyA"
        data-category="Announcements"
        data-category-id="DIC_kwDONLoiyM4CkDpF"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light_high_contrast"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

<script>
  function updateGiscusTheme() {
    const isDark = document.body.classList.contains('dark');
    const theme = isDark ? 'dark_high_contrast' : 'light_high_contrast';
    const iframe = document.querySelector('iframe.giscus-frame');
    
    if (iframe) {
      iframe.contentWindow.postMessage(
        { giscus: { setConfig: { theme } } },
        'https://giscus.app'
      );
    }
  }

  // 创建观察器监听 body 类名变化
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'class') {
        updateGiscusTheme();
      }
    });
  });

  // 开始观察 body 元素的类名变化
  observer.observe(document.body, {
    attributes: true,
    attributeFilter: ['class']
  });

  // 初始化时设置主题
  updateGiscusTheme();
</script>